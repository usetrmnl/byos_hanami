# frozen_string_literal: true

require "sidekiq/web"

require "sidekiq-scheduler/web"

require_relative "../app/aspects/screens/designer/middleware"

module Terminus
  # The application base routes.
  # rubocop:todo Metrics/ClassLength
  class Routes < Hanami::Routes
    slice(:authentication, at: "/") { use Authentication::Middleware }

    mount Sidekiq::Web, at: "/sidekiq"

    get "/", to: "dashboard.show", as: :root

    get "/api/devices", to: "api.devices.index", as: :api_devices
    get "/api/devices/:id", to: "api.devices.show", as: :api_device
    post "/api/devices", to: "api.devices.create", as: :api_device_create
    patch "/api/devices/:id", to: "api.devices.patch", as: :api_device_patch
    delete "/api/devices/:id", to: "api.devices.delete", as: :api_device_delete

    get "/api/display", to: "api.display.show", as: :api_display

    get "/api/firmware", to: "api.firmware.index", as: :api_firmware
    get "/api/firmware/:id", to: "api.firmware.show", as: :api_firmware_show
    post "/api/firmware", to: "api.firmware.create", as: :api_firmware_create
    patch "/api/firmware/:id", to: "api.firmware.patch", as: :api_firmware_patch
    delete "/api/firmware/:id", to: "api.firmware.delete", as: :api_firmware_delete

    post "/api/log", to: "api.log.create", as: :api_log_create

    get "/api/models", to: "api.models.index", as: :api_models
    get "/api/models/:id", to: "api.models.show", as: :api_model
    post "/api/models", to: "api.models.create", as: :api_model_create
    patch "/api/models/:id", to: "api.models.patch", as: :api_model_patch
    delete "/api/models/:id", to: "api.models.delete", as: :api_model_delete

    get "/api/screens", to: "api.screens.index", as: :api_screens
    post "/api/screens", to: "api.screens.create", as: :api_screen_create
    patch "/api/screens/:id", to: "api.screens.patch", as: :api_screen_patch
    delete "/api/screens/:id", to: "api.screens.delete", as: :api_screen_delete

    get "/api/setup", to: "api.setup.show", as: :api_setup

    delete "/bulk/devices/:device_id/logs",
           to: "bulk.devices.logs.delete",
           as: :bulk_device_logs_delete
    delete "/bulk/firmware", to: "bulk.firmware.delete", as: :bulk_firmware_delete

    get "/devices", to: "devices.index", as: :devices
    get "/devices/:id", to: "devices.show", as: :device
    get "/devices/new", to: "devices.new", as: :device_new
    post "/devices", to: "devices.create", as: :device_create
    get "/devices/:id/edit", to: "devices.edit", as: :device_edit
    put "/devices/:id", to: "devices.update", as: :device_update
    delete "/devices/:id", to: "devices.delete", as: :device_delete

    get "/devices/:device_id/logs", to: "devices.logs.index", as: :device_logs
    get "/devices/:device_id/logs/:id", to: "devices.logs.show", as: :device_log
    delete "/devices/:device_id/logs/:id", to: "devices.logs.delete", as: :device_log_delete

    get "/designer", to: "designer.show", as: :designer
    post "/designer", to: "designer.create", as: :designer_create

    get "/extensions", to: "extensions.index", as: :extensions
    get "/extensions/new", to: "extensions.new", as: :extension_new
    post "/extensions", to: "extensions.create", as: :extension_create
    get "/extensions/:id/edit", to: "extensions.edit", as: :extension_edit
    put "/extensions/:id", to: "extensions.update", as: :extension_update
    delete "/extensions/:id", to: "extensions.delete", as: :extension_delete

    get "/extensions/gallery", to: "extensions.gallery.index", as: :extensions_gallery
    post "/extensions/gallery", to: "extensions.gallery.create", as: :extensions_gallery_create

    post "/extensions/:extension_id/build",
         to: "extensions.build.create",
         as: :extension_build_create

    get "/extensions/:extension_id/clone/new", to: "extensions.clone.new", as: :extension_clone_new
    post "/extensions/:extension_id/clone",
         to: "extensions.clone.create",
         as: :extension_clone_create

    get "/extensions/:extension_id/preview", to: "extensions.preview.show", as: :extension_preview
    get "/extensions/:extension_id/poll", to: "extensions.poll.show", as: :extension_poll
    get "/extensions/:extension_id/sensors", to: "extensions.sensors.index", as: :extension_sensors

    get "/firmware", to: "firmware.index", as: :firmware
    get "/firmware/:id", to: "firmware.show", as: :firmware_show
    get "/firmware/new", to: "firmware.new", as: :firmware_new
    post "/firmware", to: "firmware.create", as: :firmware_create
    get "/firmware/:id/edit", to: "firmware.edit", as: :firmware_edit
    put "/firmware/:id", to: "firmware.update", as: :firmware_update
    delete "/firmware/:id", to: "firmware.delete", as: :firmware_delete

    get "/models", to: "models.index", as: :models
    get "/models/:id", to: "models.show", as: :model
    get "/models/new", to: "models.new", as: :model_new
    post "/models", to: "models.create", as: :model_create
    get "/models/:id/edit", to: "models.edit", as: :model_edit
    put "/models/:id", to: "models.update", as: :model_update
    delete "/models/:id", to: "models.delete", as: :model_delete

    get "/playlists", to: "playlists.index", as: :playlists
    get "/playlists/:id", to: "playlists.show", as: :playlist
    get "/playlists/new", to: "playlists.new", as: :playlist_new
    post "/playlists", to: "playlists.create", as: :playlist_create
    get "/playlists/:id/edit", to: "playlists.edit", as: :playlist_edit
    put "/playlists/:id", to: "playlists.update", as: :playlist_update
    delete "/playlists/:id", to: "playlists.delete", as: :playlist_delete

    get "/playlists/:playlist_id/clone/new", to: "playlists.clone.new", as: :playlist_clone_new
    post "/playlists/:playlist_id/clone", to: "playlists.clone.create", as: :playlist_clone_create

    get "/playlists/:playlist_id/items", to: "playlists.items.index", as: :playlist_items
    get "/playlists/:playlist_id/items/:id", to: "playlists.items.show", as: :playlist_item
    get "/playlists/:playlist_id/items/new", to: "playlists.items.new", as: :playlist_item_new
    post "/playlists/:playlist_id/items", to: "playlists.items.create", as: :playlist_item_create
    get "/playlists/:playlist_id/items/:id/edit",
        to: "playlists.items.edit",
        as: :playlist_item_edit
    put "/playlists/:playlist_id/items/:id", to: "playlists.items.update", as: :playlist_item_update
    delete "/playlists/:playlist_id/items/:id",
           to: "playlists.items.delete",
           as: :playlist_item_delete

    get "/playlists/:playlist_id/mirror/edit",
        to: "playlists.mirror.edit",
        as: :playlist_mirror_edit
    put "/playlists/:playlist_id/mirror", to: "playlists.mirror.update", as: :playlist_mirror_update

    get "/playlists/:playlist_id/screens", to: "playlists.screens.index", as: :playlist_screens
    get "/playlists/:playlist_id/screens/:id", to: "playlists.screens.show", as: :playlist_screen

    get "/problem_details", to: "problem_details.index", as: :problem_details

    get "/screens", to: "screens.index", as: :screens
    get "/screens/:id", to: "screens.show", as: :screen
    get "/screens/new", to: "screens.new", as: :screen_new
    post "/screens", to: "screens.create", as: :screen_create
    get "/screens/:id/edit", to: "screens.edit", as: :screen_edit
    put "/screens/:id", to: "screens.update", as: :screen_update
    delete "/screens/:id", to: "screens.delete", as: :screen_delete

    get "/users", to: "users.index", as: :users
    get "/users/:id", to: "users.show", as: :user
    get "/users/new", to: "users.new", as: :user_new
    post "/users", to: "users.create", as: :user_create
    get "/users/:id/edit", to: "users.edit", as: :user_edit
    put "/users/:id", to: "users.update", as: :user_update

    slice(:health, at: "/up") { root to: "show" }

    use Rack::Static, root: "public", urls: ["/.well-known/security.txt", "/uploads"]
    use Aspects::Screens::Designer::Middleware, pattern: %r(/preview/(?<name>.+))
  end
  # rubocop:enable Metrics/ClassLength
end
