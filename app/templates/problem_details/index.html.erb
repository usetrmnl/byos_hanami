<% content_for :title, "Problem Details | Terminus" %>

<section class="page-problem_details">
  <header class="page-header">
    <h1>Problem Details</h1>
  </header>

  <p>Welcome to the problem details page where you can information for resolving API errors.</p>

  <h2 id="device_id" class="problem">Device ID</h2>

  <p>Could not find device by ID. The device ID should be supplied via the HTTP ID header.</p>

  <h2 id="log_payload" class="problem">Log Payload</h2>

  <p>Could create log for device due to invalid payload. The payload should be structured as follows:</p>

  <pre>
    "log": {
      "logs_array": [
        {
          "log_id": 1,
          "creation_timestamp": 1742022123,
          "log_message": "returned code is not OK: 404",
          "log_codeline": 597,
          "device_status_stamp": {
            "wifi_status": "connected",
            "wakeup_reason": "timer",
            "current_fw_version": "1.5.2",
            "free_heap_size": 160656,
            "max_alloc_size": 200000,
            "special_function": "none",
            "refresh_rate": 30,
            "battery_voltage": 4.772,
            "time_since_last_sleep_start": 31,
            "wifi_rssi_level": -54
          },
          "additional_info": {
            "retry_attempt": 1
          },
          "log_sourcefile": "src/bl.cpp"
        }
      ]
    }
  </pre>

  <p>ðŸ’¡ The <code>additional_info</code> key is optional and can be be excluded but all other keys are required.</p>

  <h2 id="screen_payload" class="problem">Screen Payload</h2>

  <p>When making an API HTTP POST request, the following required and optional keys should be used within the hash provided for the <code>image</code> key.</p>

  <p><strong>Required (use only one):</strong></p>

  <dl class="site-definition-list">
    <dt class="key">content</dt>
    <dd class="value">Must be HTML content. CSS can be provided via the style tags within HTML head element if desired too.</dd>

    <dt class="key">uri</dt>
    <dd class="value">Must be an image URI. This can be either relative path or an URL to an image.</dd>

    <dt class="key">data</dt>
    <dd class="value">Must be Base64 encoded image data. In Ruby, that'd be: <code>Base64.strict_encode64 file.read</code>.</dd>
  </dl>

  <p><strong>Optional:</strong></p>

  <dl class="site-definition-list">
    <dt class="key">dimensions</dt>
    <dd class="value">
      Use to render your screen with specific dimensions. The <a href="https://www.imagemagick.org/script/command-line-processing.php#geometry">ImageMagick Geometry</a> syntax is available to you to render your screen as desired. If no dimensions are supplied, then the default dimensions of <code>800x480</code> are used.
    </dd>

    <dt class="key">file_name</dt>
    <dd class="value">Use to create a screen with an automatically generated or specific file name. Example: <code>demo.png</code>. Otherwise, if no file name is provided, a UUID will be used instead. Example: <code>e2a8a4bc-11ba-40a4-9184-5275f4172da4.png</code>. You can also use <code>%&lt;name&gt;s</code> with a file extension to render an automatically generated file. Example: <code>%&lt;name&gt;s.bmp</code>. Only <code>.bmp</code> and <code>.png</code> file extensions are supported.</dd>
  </dl>
</section>
