<%= render "shared/title", text: "Edit #{playlist.label} Playlist" %>

<section class="bit-page page-playlists">
  <header class="bit-header">
    <ul class="bit-breadcrumbs">
      <li class="bit-breadcrumb">
        <%= link_to "Playlists", routes.path(:playlists), class: :link %>
      </li>

      <li class="bit-breadcrumb">
        <%= link_to playlist.label, routes.path(:playlist, id: playlist.id), class: :link %>
      </li>

      <li class="bit-breadcrumb">Edit</li>
    </ul>
  </header>

  <div class="bit-body">
    <div class="bit-card playlist">
      <%= form_for :playlist,
                   routes.path(:playlist_update, id: playlist.id),
                   method: :put,
                   class: "bit-form" do |form| %>
        <h1 class="label">Edit Playlist</h1>

        <%= render "playlists/shared/fields", form:, playlist:, fields: fields.value, errors: %>

        <div class="form-actions">
          <%= render "shared/save_button",
                     form:,
                     verb: :put,
                     path: routes.path(:playlist_update, id: playlist.id),
                     target: ".bit-page" %>

          <a href="<%= routes.path :playlist, id: playlist.id %>"
             class="bit-button-decline"
             hx-get="<%= routes.path :playlist, id: playlist.id %>"
             hx-trigger="click"
             hx-target="closest .bit-page"
             hx-push-url="true">
             Cancel
          </a>
        </div>
      <% end %>

      <%= tag.div **HTMX[
                    get: routes.path(:playlist_items, playlist_id: playlist.id),
                    trigger: :load
                  ] %>
    </div>
  </div>
</section>
